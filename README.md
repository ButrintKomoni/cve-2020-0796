# Identifying and Mitigating the CVE-2020–0796 flaw in the fly
CVE-2020–0796, is pre-remote code execution vulnerability that resides in the Server Message Block 3.0 (SMBv3) network communication protocol, which Microsoft will not address the issue as the part of the March 2020 Tuesday.

## Usage
`python3 cve-2020-0796-scanner.py IP`

## Which devices does the CVE-2020-0796 affect?
![Affected Devices](https://miro.medium.com/max/746/1*SrDVddRM9EgS4X7DCmNIwA.png)

## Packet request negotiate on the SMB protocol 
`10.0.0.1	10.0.0.133	SMB2	250	Negotiate Protocol Request
0000   00 0c 29 42 3c fa 00 50 56 c0 00 08 08 00 45 00   ..)B<..PV.....E.
0010   00 ec 41 0b 40 00 40 06 e4 7b 0a 00 00 01 0a 00   ..A.@.@..{......
0020   00 85 d5 fc 01 bd 98 6e b1 48 35 55 50 a3 50 18   .......n.H5UP.P.
0030   00 3f 4d 6e 00 00 00 00 00 c0 fe 53 4d 42 40 00   .?Mn.......SMB@.
0040   00 00 00 00 00 00 00 00 1f 00 00 00 00 00 00 00   ................
0050   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
0060   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
0070   00 00 00 00 00 00 00 00 00 00 24 00 08 00 01 00   ..........$.....
0080   00 00 7f 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
0090   00 00 00 00 00 00 78 00 00 00 02 00 00 00 02 02   ......x.........
00a0   10 02 22 02 24 02 00 03 02 03 10 03 11 03 00 00   ..".$...........
00b0   00 00 01 00 26 00 00 00 00 00 01 00 20 00 01 00   ....&....... ...
00c0   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
00d0   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
00e0   00 00 03 00 0a 00 00 00 00 00 01 00 00 00 01 00   ................
00f0   00 00 01 00 00 00 00 00 00 00                     ..........

10.0.0.133	10.0.0.1	SMB2	572	Negotiate Protocol Response
0000   00 50 56 c0 00 08 00 0c 29 42 3c fa 08 00 45 00   .PV.....)B<...E.
0010   02 2e 4f 68 40 00 80 06 94 dc 0a 00 00 85 0a 00   ..Oh@...........
0020   00 01 01 bd d5 fc 35 55 50 a3 98 6e b2 0c 50 18   ......5UP..n..P.
0030   20 14 f4 3a 00 00 00 00 02 02 fe 53 4d 42 40 00    ..:.......SMB@.
0040   00 00 00 00 00 00 00 00 01 00 01 00 00 00 00 00   ................
0050   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
0060   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
0070   00 00 00 00 00 00 00 00 00 00 41 00 01 00 11 03   ..........A.....
0080   02 00 7c ce 6d 37 0b b2 d4 41 b8 6c f7 d2 a8 94   ..|.m7...A.l....
0090   da e2 2f 00 00 00 00 00 80 00 00 00 80 00 00 00   ../.............
00a0   80 00 0a c8 cb 6e b8 f7 d5 01 00 00 00 00 00 00   .....n..........
00b0   00 00 80 00 40 01 c0 01 00 00 60 82 01 3c 06 06   ....@.....`..<..
00c0   2b 06 01 05 05 02 a0 82 01 30 30 82 01 2c a0 1a   +........00..,..
00d0   30 18 06 0a 2b 06 01 04 01 82 37 02 02 1e 06 0a   0...+.....7.....
00e0   2b 06 01 04 01 82 37 02 02 0a a2 82 01 0c 04 82   +.....7.........
00f0   01 08 4e 45 47 4f 45 58 54 53 01 00 00 00 00 00   ..NEGOEXTS......
0100   00 00 60 00 00 00 70 00 00 00 93 27 b2 24 64 76   ..`...p....'.$dv
0110   54 04 cb a4 04 c3 09 89 39 15 70 90 1c ca 57 25   T.......9.p...W%
0120   2c 31 d8 71 4e 01 dd 04 79 60 3c f6 62 b7 2e fb   ,1.qN...y`<.b...
0130   85 e3 d5 02 e7 c5 00 29 b2 d9 00 00 00 00 00 00   .......)........
0140   00 00 60 00 00 00 01 00 00 00 00 00 00 00 00 00   ..`.............
0150   00 00 5c 33 53 0d ea f9 0d 4d b2 ec 4a e3 78 6e   ..\3S....M..J.xn
0160   c3 08 4e 45 47 4f 45 58 54 53 03 00 00 00 01 00   ..NEGOEXTS......
0170   00 00 40 00 00 00 98 00 00 00 93 27 b2 24 64 76   ..@........'.$dv
0180   54 04 cb a4 04 c3 09 89 39 15 5c 33 53 0d ea f9   T.......9.\3S...
0190   0d 4d b2 ec 4a e3 78 6e c3 08 40 00 00 00 58 00   .M..J.xn..@...X.
01a0   00 00 30 56 a0 54 30 52 30 27 80 25 30 23 31 21   ..0V.T0R0'.%0#1!
01b0   30 1f 06 03 55 04 03 13 18 54 6f 6b 65 6e 20 53   0...U....Token S
01c0   69 67 6e 69 6e 67 20 50 75 62 6c 69 63 20 4b 65   igning Public Ke
01d0   79 30 27 80 25 30 23 31 21 30 1f 06 03 55 04 03   y0'.%0#1!0...U..
01e0   13 18 54 6f 6b 65 6e 20 53 69 67 6e 69 6e 67 20   ..Token Signing 
01f0   50 75 62 6c 69 63 20 4b 65 79 01 00 26 00 00 00   Public Key..&...
0200   00 00 01 00 20 00 01 00 fb 56 86 eb b8 8f 1e b2   .... ....V......
0210   1f d1 3f 26 94 a5 a5 33 27 01 96 96 3a ca 2e cc   ..?&...3'...:...
0220   a5 a8 d2 f9 15 d7 2a 92 00 00 03 00 0a 00 00 00   ......*.........
0230   00 00 01 00 00 00 00 00 00 00 01 00               ............`




For further information on the vulnerability how to mitigate it check the post of mine in; https://medium.com/@butrintkomoni/identifying-and-mitigating-the-cve-2020-0796-flaw-in-the-fly-7f2404ebe979
